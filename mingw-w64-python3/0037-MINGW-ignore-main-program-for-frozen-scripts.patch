From 8ac0cafc48dcc34c6b680e3a290c438c9edc0bdb Mon Sep 17 00:00:00 2001
From: Roumen Petrov <local@example.net>
Date: Tue, 26 Feb 2013 23:58:17 +0200
Subject: [PATCH 07/24] MINGW: ignore main program for frozen scripts

---
 Makefile.pre.in |  2 +-
 configure.ac    | 10 ++++++++++
 2 files changed, 11 insertions(+), 1 deletion(-)

diff --git a/Makefile.pre.in b/Makefile.pre.in
index 58334fe..87a900d 100644
--- a/Makefile.pre.in
+++ b/Makefile.pre.in
@@ -338,7 +338,7 @@ PYTHON_OBJS=	\
 		Python/codecs.o \
 		Python/dynamic_annotations.o \
 		Python/errors.o \
-		Python/frozenmain.o \
+		@PYTHON_OBJS_FROZENMAIN@ \
 		Python/future.o \
 		Python/getargs.o \
 		Python/getcompiler.o \
diff --git a/configure.ac b/configure.ac
index 14e0035..0ea0f34 100644
--- a/configure.ac
+++ b/configure.ac
@@ -4787,6 +4787,16 @@ case $host in
     ;;
 esac
 
+dnl Python interpreter main program for frozen scripts
+AC_SUBST(PYTHON_OBJS_FROZENMAIN)
+PYTHON_OBJS_FROZENMAIN="Python/frozenmain.o"
+case $host in
+  *-*-mingw*)
+    dnl 'PC/frozen_dllmain.c' - not yet
+    PYTHON_OBJS_FROZENMAIN=
+    ;;
+esac
+
 AC_SUBST(SRCDIRS)
 SRCDIRS="Parser Grammar Objects Python Modules Mac"
 case $host in
-- 
1.7.12.1
