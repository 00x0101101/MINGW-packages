--- a/configure	2015-05-27 14:41:26.622651400 +0300
+++ b/configure	2015-05-27 14:44:05.788194400 +0300
@@ -48,9 +48,10 @@
 relconf=`basename $0`
 # the directory of this script is the "source tree"
 relpath=`dirname $0`
-relpath=`(cd "$relpath"; /bin/pwd)`
+relpath=$(cygpath -ma "$relpath")
+relpath=${relpath%/}
 # the current directory is the "build tree" or "object tree"
-outpath=`/bin/pwd`
+outpath=$(cygpath -ma $(/bin/pwd))
 
 #license file location
 LICENSE_FILE="$QT_LICENSE_FILE"
@@ -1376,7 +1378,7 @@
         CFG_PSQL_CONFIG="$VAL"
         ;;
     prefix)
-        QT_INSTALL_PREFIX="$VAL"
+        QT_INSTALL_PREFIX=$(cygpath -ma "$VAL")
         ;;
     hostprefix)
 	QT_HOST_PREFIX="$VAL"
@@ -3754,6 +3756,8 @@
     if [ -z "$QT_INSTALL_SETTINGS" ]; then #default
         if [ "$PLATFORM_MAC" = "yes" ]; then
 	    QT_INSTALL_SETTINGS=/Library/Preferences/Qt
+        elif [ "$XPLATFORM_MINGW" = "yes" ]; then
+	    QT_INSTALL_SETTINGS="$QT_INSTALL_PREFIX/etc"
         else
 	    QT_INSTALL_SETTINGS=/etc/xdg
         fi
@@ -4953,7 +4953,11 @@
 #           if which qmake >/dev/null 2>&1 && [ -f qmake/qmake.pro ]; then
 #               (cd qmake && qmake) >/dev/null 2>&1 && continue
 #           fi
-            in_mkfile="${mkfile}.unix"
+            if [ "$PLATFORM" = "win32-g++" ]; then
+              in_mkfile="${mkfile}.win32-g++-sh"
+            else
+              in_mkfile="${mkfile}.unix"
+            fi
         fi
         in_mkfile="$relpath/qmake/$in_mkfile"
         mkfile="$outpath/qmake/$mkfile"
