--- a/CMakeLists.txt.orig	2015-05-25 15:36:19.241200000 +0300
+++ b/CMakeLists.txt	2015-05-25 15:54:10.095600000 +0300
@@ -98,7 +98,7 @@
         string(TOUPPER ${conf} conf2)
         set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_${conf2} ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${conf}/bin)
     endforeach()
-elseif (UNIX)
+elseif (UNIX OR MINGW)
     set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${output_dir}/bin)
     set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${output_dir}/bin)
 endif()
@@ -113,7 +113,7 @@
 # icu
 ########################################
 
-if (UNIX)
+if (UNIX OR MINGW)
     if (NOT ICU_INCLUDE_DIR)
         find_path(ICU_INCLUDE_DIR unicode/ucnv.h
             PATHS
@@ -159,7 +159,9 @@
 set(FB_SERVICE_PORT 3050)
 
 if (WIN32)
+  if (NOT MINGW)
     set(FB_PREFIX "c:\\\\Program Files\\\\Firebird\\\\")
+  endif()
     set(FB_IPC_NAME "FIREBIRD")
 endif()
 
@@ -192,7 +194,7 @@
         endif()
     endif(MSVC)
 
-    set(LIB_Ws2_32 Ws2_32)
+    set(LIB_Ws2_32 ws2_32)
     set(LIB_comctl32 comctl32)
     set(LIB_mpr mpr)
     set(LIB_version version)
@@ -244,7 +246,7 @@
 #
 ################################################################################
 
-if (WIN32)
+if (MSVC)
     # icu
     if (NOT ICU_EXTRACT)
         message(STATUS "Extracting pre-built ICU")
--- a/src/CMakeLists.txt.orig	2015-05-25 15:56:46.615200000 +0300
+++ b/src/CMakeLists.txt	2015-05-25 16:00:00.460800000 +0300
@@ -105,6 +105,7 @@
     ${CMAKE_CURRENT_SOURCE_DIR}/msgs/transmsgs.fr_FR2.sql
 )
 set(databases_src
+    ${CMAKE_CURRENT_SOURCE_DIR}/dbs/metadata.sql
     ${CMAKE_CURRENT_SOURCE_DIR}/dbs/security.sql
     ${msgs_src}
 )
@@ -203,6 +206,7 @@
     DEPENDS
         boot_isql
         boot_gfix
+        metadata.fdb
         ${msgs_src}
     #
     COMMAND ${CMAKE_COMMAND} -E remove msg.fdb
@@ -852,7 +852,7 @@
 
 endif() # if (NOT CMAKE_CROSSCOMPILING)
 
-if (WIN32)
+if (MSVC)
     add_custom_command(
         TARGET boot_isql
         POST_BUILD
@@ -1004,8 +1004,8 @@
         TARGET copy_files
         POST_BUILD
         # lib
-        COMMAND ${CMAKE_COMMAND} -E copy_if_different $<CONFIG>/fbclient.lib ${output_dir}/lib/fbclient_ms.lib
-        COMMAND ${CMAKE_COMMAND} -E copy_if_different $<CONFIG>/ib_util.lib ${output_dir}/lib/ib_util_ms.lib
+        COMMAND ${CMAKE_COMMAND} -E copy_if_different $<CONFIG>/libfbclient.dll.a ${output_dir}/lib/libfbclient.dll.a
+        COMMAND ${CMAKE_COMMAND} -E copy_if_different $<CONFIG>/libib_util.dll.a ${output_dir}/lib/libib_util.dll.a
         # installers
         COMMAND ${CMAKE_COMMAND} -E copy_if_different ${CMAKE_SOURCE_DIR}/builds/install/arch-specific/win32/install_classic.bat ${output_dir}/install_classic.bat
         COMMAND ${CMAKE_COMMAND} -E copy_if_different ${CMAKE_SOURCE_DIR}/builds/install/arch-specific/win32/install_super.bat ${output_dir}/install_super.bat
