# Contributor: LI Xuzhang <lixuzhang@gmail.com>

_realname=libmodbus
pkgname="${MINGW_PACKAGE_PREFIX}-${_realname}-git"
pkgver=v3.1.2.11.g98c4aca
pkgrel=1
pkgdesc="A Modbus library for Linux, Mac OS X, FreeBSD, QNX and Win32 (mingw-w64)"
arch=('any')
license=('LGPL')
makedepends=(git "${MINGW_PACKAGE_PREFIX}-gcc"
"${MINGW_PACKAGE_PREFIX}-pkg-config")
provides=(libmodbus)
depends=()
options=(!strip !buildflags staticlibs)
source=("git://github.com/stephane/libmodbus")
url="http://libmodbus.org/"
md5sums=('SKIP')

pkgver() {
  cd $_realname
  #echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
  git describe --tags |sed 's+-+.+g'
}

build() {
  cd $_realname
  ./autogen.sh
  CFLAGS="" ./configure --prefix=${MINGW_PREFIX} --without-documentation
  make
}

package() {
  cd $_realname
  make DESTDIR="$pkgdir/" install
}
